<template>
  <div class="main-box">
    <!-- support  footer需要的svg,网站中通过js加载的svg，这里是拿不到的，需要单独加上 -->
    <svg style="position: absolute; width: 0px; height: 0px; overflow: hidden;">
      <symbol id="icon-facebook" viewBox="0 0 1024 1024">
        <path
          d="M768 57.856v146.218667h-93.013333c-34.005333 0-56.917333 6.613333-68.778667 19.925333-11.818667 13.312-17.749333 33.237333-17.749333 59.818667v104.661333h173.653333l-23.168 163.968h-150.485333V972.8h-181.333334v-420.352H256V388.48h151.125333v-120.746667c0-68.693333 20.522667-121.898667 61.610667-159.744S564.522667 51.2 632.874667 51.2c58.069333 0 103.125333 2.218667 135.125333 6.656z"
          fill="#323431"
        ></path>
      </symbol>
      <symbol id="icon-youtube" viewBox="0 0 1024 1024">
        <path
          d="M962.986667 273.92c6.869333 29.866667 13.738667 78.08 16.042666 140.032l2.304 84.906667v89.514666c-2.304 64.256-9.173333 112.426667-16.085333 142.293334-4.565333 18.346667-16.042667 36.693333-29.824 50.474666a109.781333 109.781333 0 0 1-52.778667 29.866667c-29.866667 6.826667-98.688 13.738667-208.853333 18.346667l-160.64 2.261333-156.074667-2.261333c-110.165333-4.608-178.986667-9.173333-208.853333-18.346667a109.781333 109.781333 0 0 1-52.778667-29.866667c-18.346667-13.781333-27.52-32.128-34.432-50.474666-6.869333-32.128-13.738667-78.08-16.042666-142.293334L42.666667 503.466667c0-25.258667 0-52.821333 2.304-84.906667 2.304-61.994667 9.173333-110.208 16.042666-140.032 6.912-25.258667 16.085333-43.605333 32.128-57.386667 16.085333-13.738667 32.128-25.216 52.821334-32.128 29.824-6.869333 98.645333-13.738667 208.810666-16.042666L513.152 170.666667l156.074667 2.304c110.165333 2.304 181.290667 9.173333 211.114666 16.042666 20.650667 4.608 39.04 16.085333 52.778667 29.866667 13.781333 16.042667 25.258667 34.389333 29.866667 55.04zM416.768 643.413333l245.546667-139.946666-245.546667-140.032v280.021333z"
          fill="#323431"
        ></path>
      </symbol>
      <symbol id="icon-pinterest" viewBox="0 0 1024 1024">
        <path
          d="M853.333333 369.152c0 224.170667-124.586667 391.04-307.925333 391.04-61.568 0-119.466667-33.365333-138.837333-71.210667-33.322667 131.370667-40.021333 156.544-40.021334 156.544-11.946667 43.776-36.309333 87.637333-57.813333 121.728-61.226667 43.264-66.901333-23.68-66.901333-23.68-1.408-40.149333-0.725333-88.362667 9.728-131.328 0 0 11.093333-46.08 73.386666-310.186666-18.517333-36.437333-18.517333-90.581333-18.517333-90.581334 0-84.608 49.066667-147.712 109.909333-147.712 51.925333 0 77.098667 39.338667 77.098667 86.101334 0 51.968-33.450667 129.92-50.389333 201.898666-14.08 60.842667 30.378667 109.824 89.728 109.824 108.416 0 181.034667-138.709333 181.034666-302.762666 0-125.44-84.522667-218.88-237.44-218.88-172.842667 0-280.448 129.109333-280.448 273.066666 0 49.749333 14.805333 84.608 37.802667 112.085334 10.453333 12.629333 11.946667 17.024 8.149333 31.872-2.858667 10.410667-8.789333 35.626667-11.776 45.226666-3.712 14.890667-15.616 20.053333-28.16 14.890667C122.453333 584.32 85.333333 496.810667 85.333333 398.848 85.333333 237.056 221.824 42.666667 491.989333 42.666667 710.186667 42.666667 853.333333 200.661333 853.333333 369.152z"
          fill="#323431"
        ></path>
      </symbol>
      <symbol id="icon-twitter" viewBox="0 0 1024 1024">
        <path
          d="M1006.933333 217.088a404.565333 404.565333 0 0 1-99.114666 97.834667 516.394667 516.394667 0 0 1-22.613334 176.64 538.837333 538.837333 0 0 1-70.741333 145.621333 581.802667 581.802667 0 0 1-112.853333 123.306667c-43.648 35.797333-96.298667 64.298667-157.866667 85.589333-61.568 21.248-127.445333 31.872-197.632 31.914667-110.506667 0-211.669333-28.330667-303.445333-84.949334 14.293333 1.536 30.165333 2.304 47.744 2.304 91.733333 0 173.525333-26.922667 245.333333-80.853333a198.272 198.272 0 0 1-115.029333-37.76c-33.834667-24.448-57.088-55.594667-69.76-93.44 13.482667 1.92 25.898667 2.901333 37.333333 2.901333 17.493333 0 34.858667-2.133333 52.010667-6.442666a196.266667 196.266667 0 0 1-113.493334-65.322667 178.133333 178.133333 0 0 1-45.013333-120.405333V391.68c27.733333 14.848 57.514667 22.869333 89.301333 24.021333a192.213333 192.213333 0 0 1-64.213333-67.413333 178.346667 178.346667 0 0 1-23.893333-90.24c0-34.346667 9.002667-66.176 26.965333-95.488A556.245333 556.245333 0 0 0 290.133333 302.293333a569.898667 569.898667 0 0 0 227.285334 58.325334 201.557333 201.557333 0 0 1-4.864-43.349334c0-52.352 19.242667-96.981333 57.813333-133.888 38.570667-36.906667 85.162667-55.338667 139.776-55.381333 57.130667 0 105.258667 19.925333 144.384 59.733333a398.293333 398.293333 0 0 0 125.44-45.653333c-15.104 44.885333-44.074667 79.658667-86.869333 104.277333a407.808 407.808 0 0 0 113.749333-29.312h0.085333z"
          fill="#323431"
        ></path>
      </symbol>
      <symbol id="icon-tiktok" viewBox="0 0 1024 1024">
        <path
          d="M498.986667 51.968c50.005333-0.768 99.626667-0.384 149.290666-0.768 3.029333 58.752 24.021333 118.656 66.773334 160.128 42.752 42.624 103.082667 62.208 161.877333 68.693333v154.794667c-54.954667-1.92-110.336-13.44-160.341333-37.248-21.76-9.984-41.984-22.656-61.866667-35.712-0.341333 112.128 0.426667 224.256-0.725333 336a294.4 294.4 0 0 1-51.541334 151.296c-50.005333 73.728-136.661333 121.728-225.621333 123.264-54.613333 3.072-109.184-11.946667-155.733333-39.552-77.141333-45.696-131.328-129.408-139.349334-219.306667-0.768-19.2-1.152-38.4-0.384-57.173333a288.725333 288.725333 0 0 1 98.474667-190.464c63.402667-55.296 151.936-81.792 234.794667-66.048 0.768 56.832-1.536 113.664-1.536 170.496-37.802667-12.288-82.090667-8.832-115.285334 14.208a133.248 133.248 0 0 0-51.925333 67.2c-8.021333 19.584-5.717333 41.088-5.333333 61.824 9.173333 62.976 69.461333 115.968 133.632 110.208 42.752-0.426667 83.584-25.344 105.728-61.866667 7.253333-12.629333 15.274667-25.685333 15.658666-40.661333 3.84-68.736 2.261333-137.088 2.645334-205.824 0.426667-154.752-0.384-309.12 0.768-463.488z"
          fill="#323431"
        ></path>
      </symbol>
      <symbol id="icon-Instagram" viewBox="0 0 1024 1024">
        <path
          d="M511.914667 383.957333A128.341333 128.341333 0 0 0 383.829333 512a128.341333 128.341333 0 0 0 128.085334 128.042667A128.341333 128.341333 0 0 0 639.957333 512a128.341333 128.341333 0 0 0-128.042666-128.042667zM895.957333 512c0-53.034667 0.512-105.557333-2.474666-158.506667-2.986667-61.482667-17.024-116.053333-61.952-161.024-45.056-45.056-99.541333-58.965333-161.024-61.952-53.034667-2.986667-105.557333-2.474667-158.506667-2.474666-53.034667 0-105.557333-0.512-158.506667 2.474666-61.482667 2.986667-116.053333 17.024-161.024 61.952C147.413333 237.525333 133.546667 292.010667 130.56 353.493333c-2.986667 53.034667-2.474667 105.557333-2.474667 158.506667 0 52.906667-0.512 105.557333 2.474667 158.506667 2.986667 61.482667 17.024 116.053333 61.952 161.024 45.056 45.056 99.541333 58.965333 161.024 61.952 53.034667 2.986667 105.557333 2.474667 158.506667 2.474666 53.034667 0 105.557333 0.512 158.506666-2.474666 61.482667-2.986667 116.053333-17.024 161.024-61.952 45.056-45.056 58.965333-99.541333 61.952-161.024 3.072-52.906667 2.474667-105.472 2.474667-158.506667z m-384.042666 197.034667A196.736 196.736 0 0 1 314.88 512a196.736 196.736 0 0 1 197.034667-197.034667A196.736 196.736 0 0 1 708.949333 512a196.736 196.736 0 0 1-197.034666 197.034667z m205.098666-356.138667a45.952 45.952 0 0 1-46.037333-45.994667c0-25.472 20.565333-45.994667 46.037333-45.994666a45.952 45.952 0 0 1 32.554667 78.549333 45.952 45.952 0 0 1-32.554667 13.44z"
          fill="#323431"
        ></path>
      </symbol>
    </svg>
    <az-footer></az-footer>
    <main-app v-if="showMainApp"></main-app>
  </div>
</template>

<script>
import mainApp from '@/components/Main'
import azFooter from '@/components/common/AzFooter'
import { init } from '@/plugins/commonAsyncData'
import { addGTM } from '@/assets/js/utils'

export default {
  name: 'SupportFooter',
  components: {
    mainApp,
    azFooter
  },
  data() {
    return {
      showMainApp: false
    }
  },
  async asyncData(context) {
    try {
      const commonAsyncData = await init(context)
      if (!commonAsyncData) return

      return {
        ...commonAsyncData
      }
    } catch (error) {
      if (!/axios/.test(error)) {
        context.app.$throw(error, { $options: { name: context.route.name }, $route: context.route }, 'asyncdata')
      }
      context.error({
        statusCode: 200,
        message: 'service are unavailable temporarily, please refresh page!'
      })
    }
  },
  mounted() {
    let url = ''
    if (parent !== window) {
      try {
        url = parent.location.href
      } catch (e) {
        url = document.referrer
      }
    }
    if (url.includes('subsite=bridal') || location.href.includes('subsite=bridal')) {
      this.$store.commit('setIsBridal', true)
    }
  },
  head() {
    const headJson = {
      script: [
        {
          innerHTML: `var base = document.createElement('base');base.setAttribute('target', '_parent');document.head.appendChild(base)`,
          hid: 'baseHtml'
        }
      ],
      noscript: [],
      __dangerouslyDisableSanitizersByTagID: { baseHtml: ['innerHTML'] }
    }
    const glVar = typeof window === 'object' ? window : global
    const store = this.$store || this.store
    const langKey = `langs${store.state.language}`

    let glHTML = ''
    glHTML = `window.${langKey} =` + JSON.stringify(glVar[langKey])
    headJson.script.push({ innerHTML: glHTML, hid: 'global_data' })
    headJson.__dangerouslyDisableSanitizersByTagID.global_data = ['innerHTML']
    headJson.title = headJson.title === 'Azazie' || !headJson.title ? 'Azazie Footer' : headJson.title

    // gtm 打点覆盖第三方页面
    addGTM(headJson, store.state.country)
    return headJson
  }
}
</script>

<style lang="less" scoped></style>
